import{j as e,u as s,g as t,b as a}from"./index-SvUTDYpM.js";import{r as l,u as r}from"./react-c0U51vzo.js";import{P as i}from"./PageHeader-yfs0G1du.js";import{l as n}from"./courses-BxWJLNIE.js";import{listEnrollmentsForStudent as c,listEnrollments as d}from"./enrollments-3oX83C0U.js";import{g as o,a as m,c as x,b as u}from"./assignments-Dtn30G5f.js";import{g as h,a as g,b as j,c as p,d as b,e as N}from"./sessions--x-CNuOM.js";import{C as f,b as v,a as y,c as w}from"./card-C7UMvtm_.js";import{c as D,G as S,b as C,A,f as k,F as T,T as M,o as z,p as I,C as L,q as P,r as B,i as $,s as U,t as O,D as F,u as G,P as V,v as E,w as R,x as Y,y as H,z as q,N as Q,I as K}from"./icons-C41eJsKq.js";import{B as J}from"./badge-mKe8BOon.js";import{B as W}from"./button-C_oKDOXG.js";import"./firebase-Bz9ybdfi.js";import"./utils-CCUt_dAN.js";const X=l.memo(({userStats:s,statsLoading:t,role:a})=>t?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((s,t)=>e.jsx(f,{className:"animate-pulse",children:e.jsxs(v,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})},t))}):s?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(f,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.totalUsers}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",s.activeUsers," active"]})]})]}),e.jsxs(f,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Students"}),e.jsx(S,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.students}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(s.students/s.totalUsers*100).toFixed(1),"% of total"]})]})]}),e.jsxs(f,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Teachers"}),e.jsx(C,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.teachers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Faculty members"})]})]}),e.jsxs(f,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Admins"}),e.jsx(A,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.admins}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"System administrators"})]})]})]}):null);X.displayName="DashboardStats";const Z=l.memo(({courses:s,enrollments:t,courseEnrollments:a,coursesLoading:r,role:i,onNavigateToCourse:n})=>{const[c,d]=l.useState(null);if(r)return e.jsxs(f,{className:"mb-8",children:[e.jsx(y,{children:e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 animate-pulse"})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,t)=>e.jsx("div",{className:"h-20 bg-gray-200 rounded animate-pulse"},t))})})]});const o=l.useMemo(()=>"student"===i?s.filter(e=>t.some(s=>s.courseId===e.id)):s,[i,s,t]);return e.jsxs(f,{className:"mb-8",children:[e.jsx(y,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),"student"===i?"My Courses":"Course Overview"]})}),e.jsx(v,{children:0===o.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(C,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"student"===i?"No courses enrolled yet":"No courses available"})]}):e.jsxs("div",{className:"space-y-4",children:[o.slice(0,3).map(s=>{const t=a[s.id]||0;return e.jsx("div",{className:"rounded-2xl border border-slate-200/70 bg-white p-5 shadow-sm transition duration-200 hover:-translate-y-0.5 hover:shadow-md",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:s.title}),e.jsx(J,{variant:"secondary",children:s.code})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"h-4 w-4"}),t," students"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-4 w-4"}),s.semester]})]}),e.jsx("p",{className:"text-sm leading-relaxed text-slate-600 line-clamp-2",children:s.description})]}),e.jsx(W,{onClick:()=>n(s.id),className:"w-full justify-center text-sm md:w-auto",size:"sm",children:"View Course"})]})},s.id)}),o.length>3&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(W,{variant:"outline",children:["View All Courses (",o.length,")"]})})]})})]})});Z.displayName="CourseOverview";const _=l.memo(({assignmentsDue:s,overdueAssignments:t,overallGrade:a,attendance:l})=>{const r=s.length+t.length,i=s.filter(e=>{const s=new Date(e.dueAt),t=new Date;return Math.ceil((s.getTime()-t.getTime())/864e5)<=3}),n=[{label:"A (90-100%)",isActive:a>=90,barClass:"bg-emerald-500",textClass:"text-emerald-600"},{label:"B (80-89%)",isActive:a>=80&&a<90,barClass:"bg-blue-500",textClass:"text-blue-600"},{label:"C (70-79%)",isActive:a>=70&&a<80,barClass:"bg-amber-500",textClass:"text-amber-600"}];return e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs(f,{children:[e.jsx(y,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5","aria-hidden":"true"}),"Assignment Status"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[t.length>0&&e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-red-200 bg-red-50/80 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"h-5 w-5 text-red-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-800",children:"Overdue"}),e.jsxs("p",{className:"text-sm text-red-600",children:[t.length," assignment",1!==t.length?"s":""]})]})]}),e.jsx(W,{type:"button",variant:"outline",size:"sm",className:"border-red-200 text-red-700 hover:bg-red-50",children:"View All"})]}),i.length>0&&e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-amber-200 bg-amber-50/80 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"h-5 w-5 text-amber-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-800",children:"Due Soon"}),e.jsxs("p",{className:"text-sm text-amber-600",children:[i.length," assignment",1!==i.length?"s":""," in 3 days"]})]})]}),e.jsx(W,{type:"button",variant:"outline",size:"sm",className:"border-amber-200 text-amber-700 hover:bg-amber-50",children:"View All"})]}),0===t.length&&0===i.length&&s.length>0&&e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-emerald-200 bg-emerald-50/80 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{className:"h-5 w-5 text-emerald-500","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-emerald-800",children:"On Track"}),e.jsxs("p",{className:"text-sm text-emerald-600",children:[s.length," assignment",1!==s.length?"s":""," due"]})]})]}),e.jsx(W,{type:"button",variant:"outline",size:"sm",className:"border-emerald-200 text-emerald-700 hover:bg-emerald-50",children:"View All"})]}),0===r&&e.jsxs("div",{className:"rounded-2xl border border-slate-200/70 bg-slate-50/80 p-6 text-center",children:[e.jsx(T,{className:"mx-auto h-12 w-12 text-slate-400","aria-hidden":"true"}),e.jsx("p",{className:"mt-3 text-sm text-slate-600",children:"No assignments found"})]})]})})]}),e.jsxs(f,{children:[e.jsx(y,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5","aria-hidden":"true"}),"Performance Metrics"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overall Grade"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[a.toFixed(1),"%"]})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full "+(a>=90?"bg-emerald-100":a>=80?"bg-blue-100":a>=70?"bg-amber-100":"bg-red-100"),children:e.jsx(I,{className:"h-6 w-6 "+(a>=90?"text-emerald-600":a>=80?"text-blue-600":a>=70?"text-amber-600":"text-red-600"),"aria-hidden":"true"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Attendance Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[l.toFixed(1),"%"]})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full "+(l>=90?"bg-emerald-100":l>=80?"bg-blue-100":l>=70?"bg-amber-100":"bg-red-100"),children:e.jsx(z,{className:"h-6 w-6 "+(l>=90?"text-emerald-600":l>=80?"text-blue-600":l>=70?"text-amber-600":"text-red-600"),"aria-hidden":"true"})})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"mb-3 text-sm font-medium text-gray-600",children:"Grade Distribution"}),e.jsx("div",{className:"space-y-2",children:n.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-slate-200/70 px-3 py-2 text-sm "+(s.isActive?"bg-slate-50":"bg-white"),children:[e.jsx("span",{className:s.isActive?`font-semibold ${s.textClass}`:"text-slate-500",children:s.label}),e.jsx("span",{"aria-hidden":"true",className:`inline-flex h-2 w-16 overflow-hidden rounded-full bg-slate-200 ${s.isActive?s.barClass:""}`})]},s.label))})]})]})})]})]})});_.displayName="AssignmentOverview";const ee=l.memo(({currentSession:s,nextSession:t,sessionsLoading:a})=>{const[r,i]=l.useState(null);if(a)return e.jsxs(f,{className:"mb-8",children:[e.jsx(y,{children:e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 animate-pulse"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-24 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-24 bg-gray-200 rounded animate-pulse"})]})})]});const n=e=>e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e.jsxs(f,{className:"mb-8",children:[e.jsx(y,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Session Overview"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[s&&e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Current Session"}),e.jsx(J,{className:s.isCurrent?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800",children:s.isCurrent?"Current":"Active"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.name," ",s.year]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsxs("span",{children:[n(s.startDate instanceof Date?s.startDate:s.startDate.toDate())," - ",n(s.endDate instanceof Date?s.endDate:s.endDate.toDate())]})]})]}),e.jsxs("h4",{className:"font-medium mb-2",children:[s.name," ",s.year," Academic Session"]}),e.jsx("p",{className:"text-gray-700 text-sm mb-3",children:s.description||"Academic session period"})]}),e.jsx(W,{variant:"ghost",size:"sm",onClick:()=>i("current"===r?null:"current"),children:"current"===r?e.jsx(P,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"})})]}),"current"===r&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium",children:n(s.startDate instanceof Date?s.startDate:s.startDate.toDate())})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsxs("span",{className:"font-medium",children:[Math.round(((s.endDate instanceof Date?s.endDate:s.endDate.toDate()).getTime()-(s.startDate instanceof Date?s.startDate:s.startDate.toDate()).getTime())/864e5)," days"]})]})]})})]}),t&&e.jsxs("div",{className:"border rounded-lg p-4 bg-blue-50/50",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Next Session"}),e.jsx(J,{className:"bg-blue-100 text-blue-800",children:"Upcoming"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.name," ",t.year]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsxs("span",{children:[n(t.startDate instanceof Date?t.startDate:t.startDate.toDate())," - ",n(t.endDate instanceof Date?t.endDate:t.endDate.toDate())]})]})]}),e.jsxs("h4",{className:"font-medium mb-2",children:[t.name," ",t.year," Academic Session"]}),e.jsx("p",{className:"text-gray-700 text-sm mb-3",children:t.description||"Upcoming academic session period"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:["Starts ",n(t.startDate instanceof Date?t.startDate:t.startDate.toDate())]})]})]}),e.jsx(W,{variant:"ghost",size:"sm",onClick:()=>i("next"===r?null:"next"),children:"next"===r?e.jsx(P,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"})})]}),"next"===r&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium",children:n(t.startDate instanceof Date?t.startDate:t.startDate.toDate())})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsxs("span",{className:"font-medium",children:[Math.round(((t.endDate instanceof Date?t.endDate:t.endDate.toDate()).getTime()-(t.startDate instanceof Date?t.startDate:t.startDate.toDate()).getTime())/864e5)," days"]})]})]})})]}),!s&&!t&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(L,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No upcoming sessions scheduled"})]})]})})]})});ee.displayName="SessionOverview";const se=l.memo(({role:s,onNavigate:t})=>{const a="admin"===s?"from-emerald-600 to-teal-600":"teacher"===s?"from-indigo-600 to-violet-600":"from-blue-600 to-teal-600",l=`bg-gradient-to-r ${a}`,r="admin"===s?"hover:shadow-emerald-500/10 hover:border-emerald-200 focus-visible:ring-emerald-500/40":"teacher"===s?"hover:shadow-indigo-500/10 hover:border-indigo-200 focus-visible:ring-indigo-500/40":"hover:shadow-sky-500/10 hover:border-sky-200 focus-visible:ring-sky-500/40",i=(()=>{switch(s){case"admin":return[{title:"Manage Users",description:"Add, edit, and manage user accounts",icon:D,path:"/manage-users",accent:"text-sky-600",accentBg:"bg-sky-100"},{title:"System Settings",description:"Configure system preferences",icon:$,path:"/settings",accent:"text-slate-600",accentBg:"bg-slate-100"},{title:"Database Admin",description:"Oversee data and backups",icon:G,path:"/database-admin",accent:"text-teal-600",accentBg:"bg-teal-100"},{title:"Announcements",description:"Create and manage announcements",icon:U,path:"/announcements",accent:"text-emerald-600",accentBg:"bg-emerald-100"}];case"teacher":return[{title:"Create Assignment",description:"Add new assignments for students",icon:V,path:"/assignments/new",accent:"text-sky-600",accentBg:"bg-sky-100"},{title:"Grade Submissions",description:"Review and grade student work",icon:T,path:"/assignments/grade",accent:"text-emerald-600",accentBg:"bg-emerald-100"},{title:"Manage Courses",description:"View and manage your courses",icon:C,path:"/courses",accent:"text-teal-600",accentBg:"bg-teal-100"},{title:"Attendance",description:"Take attendance for sessions",icon:L,path:"/attendance",accent:"text-amber-600",accentBg:"bg-amber-100"}];default:return[{title:"View Courses",description:"Browse available courses",icon:C,path:"/courses",accent:"text-sky-600",accentBg:"bg-sky-100"},{title:"My Assignments",description:"View and submit assignments",icon:T,path:"/assignments",accent:"text-emerald-600",accentBg:"bg-emerald-100"},{title:"Grade Book",description:"Check your grades and progress",icon:G,path:"/gradebook",accent:"text-teal-600",accentBg:"bg-teal-100"},{title:"Schedule",description:"View your class schedule",icon:L,path:"/schedule",accent:"text-amber-600",accentBg:"bg-amber-100"}]}})();return e.jsxs(f,{className:"mb-8",children:[e.jsx(y,{children:e.jsx(w,{children:e.jsx("span",{className:`bg-gradient-to-r ${a} bg-clip-text text-transparent`,children:"Quick Actions"})})}),e.jsxs(v,{children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:i.map((s,a)=>e.jsx(W,{onClick:()=>t(s.path),className:`group h-full w-full rounded-2xl ${l} text-white p-6 text-left shadow-sm transition duration-200 hover:-translate-y-0.5 hover:shadow-xl focus-visible:outline-none focus-visible:ring-2`,children:e.jsxs("div",{className:"flex w-full items-start gap-4",children:[e.jsx("span",{className:"flex h-12 w-12 flex-none items-center justify-center rounded-xl bg-white/15 border border-white/20",children:e.jsx(s.icon,{className:"h-6 w-6 text-white","aria-hidden":"true"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-base font-bold text-white leading-tight",children:s.title}),e.jsx("p",{className:"mt-2 text-sm text-white/90 leading-relaxed",children:s.description})]})]})},a))}),e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[e.jsxs(W,{variant:"outline",size:"sm",onClick:()=>t("/settings"),className:`flex h-20 flex-col items-center justify-center gap-2 text-sm font-semibold text-slate-700 hover:text-slate-900 ${r}`,children:[e.jsx($,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Settings"})]}),e.jsxs(W,{variant:"outline",size:"sm",onClick:()=>t("/announcements"),className:`flex h-20 flex-col items-center justify-center gap-2 text-sm font-semibold text-slate-700 hover:text-slate-900 ${r}`,children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Announcements"})]}),"student"===s&&e.jsxs(e.Fragment,{children:[e.jsxs(W,{variant:"outline",size:"sm",onClick:()=>t("/enrollments"),className:"flex h-20 flex-col items-center justify-center gap-2 text-sm font-semibold text-slate-700 hover:text-slate-900",children:[e.jsx(O,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Enrollments"})]}),e.jsxs(W,{variant:"outline",size:"sm",onClick:()=>{},className:"flex h-20 flex-col items-center justify-center gap-2 text-sm font-semibold text-slate-700 hover:text-slate-900",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Transcript"})]})]})]})})]})]})});function te({mdYear:s,overallGrade:t,attendance:a,creditsInProgress:l,enrolledCourses:r,currentSemester:i}){const n=[{label:"Overall Grade",value:`${Number.isFinite(t)?t.toFixed(1):"--"}%`,description:"Cumulative performance across courses",icon:E},{label:"Attendance",value:`${Number.isFinite(a)?a.toFixed(1):"--"}%`,description:"Present rate over the active term",icon:R},{label:"Total Courses",value:Number.isFinite(r)?String(r):"--",description:"Active courses this term",icon:C},{label:"Current Semester",value:s??i??"Not set",description:"Your current MD semester",icon:S}];return e.jsxs("section",{"aria-labelledby":"student-snapshot-heading",className:"rounded-3xl border border-slate-200 bg-white/90 backdrop-blur-sm shadow-sm",children:[e.jsxs("header",{className:"border-b border-slate-200/70 px-6 py-4",children:[e.jsx("h2",{id:"student-snapshot-heading",className:"text-lg font-semibold text-slate-800",children:"Academic Snapshot"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Key indicators for your current term"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 px-6 py-6 sm:grid-cols-2 xl:grid-cols-4",children:n.map(s=>{const t=s.icon;return e.jsxs("article",{className:"flex items-start gap-4 rounded-2xl border border-slate-200/70 bg-slate-50/60 px-5 py-4 transition hover:border-blue-200 hover:bg-white",children:[e.jsx("span",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-blue-500/10 text-blue-600",children:e.jsx(t,{className:"h-5 w-5","aria-hidden":"true"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:s.label}),e.jsx("p",{className:"text-2xl font-semibold text-slate-800",children:s.value}),e.jsx("p",{className:"text-sm text-slate-500",children:s.description})]})]},s.label)})})]})}function ae({upcomingAssignments:s,overdueAssignments:t,onNavigate:a}){const l=s.length>0,r=t.length>0;return e.jsxs(f,{className:"h-full",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(w,{className:"flex items-center gap-2 text-base font-semibold text-slate-800",children:[e.jsx(T,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),"Assignments & Deadlines"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Stay ahead of your coursework with the next due dates."})]}),e.jsx(W,{variant:"outline",size:"sm",onClick:()=>a("/assignments"),className:"whitespace-nowrap",children:"View All"})]}),e.jsxs(v,{className:"space-y-5",children:[r&&e.jsxs("div",{className:"flex items-start gap-3 rounded-2xl border border-red-200 bg-red-50/80 p-4",children:[e.jsx("span",{className:"rounded-xl bg-red-100/90 p-2 text-red-600",children:e.jsx(M,{className:"h-5 w-5","aria-hidden":"true"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-red-700",children:[t.length," overdue assignment",1===t.length?"":"s"]}),e.jsx("p",{className:"text-sm text-red-600",children:"Submit as soon as possible to avoid grade impact."})]})]}),l?e.jsx("ul",{className:"space-y-3",children:s.slice(0,4).map(s=>{const t=new Date(s.dueAt).toLocaleString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});return e.jsxs("li",{className:"flex items-start justify-between gap-4 rounded-2xl border border-slate-200/70 bg-white px-4 py-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-semibold text-slate-800",children:s.title}),s.courseTitle&&e.jsx("p",{className:"text-sm text-slate-500",children:s.courseTitle}),e.jsxs("p",{className:"flex items-center gap-2 text-xs font-medium uppercase tracking-wide text-slate-500",children:[e.jsx(Y,{className:"h-4 w-4 text-blue-500","aria-hidden":"true"}),"Due ",t]})]}),e.jsx(W,{size:"sm",variant:"outline",className:"self-center whitespace-nowrap",onClick:()=>a(s.courseId?`/courses/${s.courseId}/assignments`:"/assignments"),children:"Open"})]},s.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center rounded-2xl border border-slate-200/70 bg-slate-50/60 p-6 text-center",children:[e.jsx(z,{className:"h-10 w-10 text-emerald-500","aria-hidden":"true"}),e.jsx("p",{className:"mt-3 text-sm font-medium text-slate-600",children:"You are up to date! No upcoming deadlines for the next few days."})]}),!r&&l&&e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-blue-200 bg-blue-50/80 px-4 py-3 text-sm text-blue-700",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4","aria-hidden":"true"}),"Use the assignment planner to block study time."]}),e.jsx(W,{variant:"ghost",size:"sm",className:"text-blue-700 hover:bg-blue-100",onClick:()=>a("/sessions"),children:"Open Planner"})]})]})]})}function le({currentSession:s,nextSession:t,upcomingAssignments:a,onNavigate:r}){const i=l.useMemo(()=>{const e=new Date;e.setHours(0,0,0,0);const s=new Date(e.getTime());return s.setHours(23,59,59,999),a.filter(t=>{const a=t.dueAt??0;return a>=e.getTime()&&a<=s.getTime()})},[a]),n=l.useMemo(()=>{if(!s)return null;const e=s.startDate instanceof Date?s.startDate:s.startDate.toDate(),t=s.endDate instanceof Date?s.endDate:s.endDate.toDate();return{label:j(s),status:g(s),progress:h(s),startLabel:e.toLocaleDateString([],{month:"short",day:"numeric"}),endLabel:t.toLocaleDateString([],{month:"short",day:"numeric"}),description:s.description||"Current academic term in progress."}},[s]),c=l.useMemo(()=>{if(!t)return null;const e=t.startDate instanceof Date?t.startDate:t.startDate.toDate();return{label:j(t),startLabel:e.toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),description:t.description||"Prepare any requirements before the next term begins."}},[t]);return e.jsxs(f,{className:"h-full",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(w,{className:"flex items-center gap-2 text-base font-semibold text-slate-800",children:[e.jsx(L,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),"Planner & Timeline"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Review what needs attention today and what is coming next."})]}),e.jsx(W,{variant:"outline",size:"sm",onClick:()=>r("/sessions"),className:"whitespace-nowrap",children:"Open Calendar"})]}),e.jsxs(v,{className:"space-y-6",children:[e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500",children:"Today at a Glance"}),i.length>0?e.jsx("ul",{className:"space-y-2",children:i.map(s=>{const t=new Date(s.dueAt??0).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"});return e.jsxs("li",{className:"flex items-start justify-between gap-3 rounded-2xl border border-slate-200/70 bg-white px-4 py-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-slate-800",children:s.title}),s.courseTitle&&e.jsx("p",{className:"text-xs text-slate-500",children:s.courseTitle})]}),e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-3 py-1 text-xs font-medium text-blue-600",children:[e.jsx(H,{className:"h-4 w-4","aria-hidden":"true"}),t]})]},s.id)})}):e.jsx("div",{className:"rounded-2xl border border-slate-200/70 bg-slate-50/80 px-4 py-5 text-sm text-slate-600",children:"No hard deadlines today—consider reviewing course materials or prepping for upcoming sessions."})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500",children:"Academic Timeline"}),n?e.jsxs("div",{className:"rounded-2xl border border-slate-200/70 bg-white px-4 py-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-700",children:n.label}),e.jsx("p",{className:"text-xs text-slate-500",children:n.description})]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-blue-50 px-3 py-1 text-xs font-medium text-blue-600",children:[e.jsx(q,{className:"h-3 w-3","aria-hidden":"true"}),"current"===n.status?"In Progress":"upcoming"===n.status?"Upcoming":"Completed"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs font-medium text-slate-500",children:[e.jsx("span",{children:n.startLabel}),e.jsx("span",{children:n.endLabel})]}),e.jsx("div",{className:"mt-2 h-2 rounded-full bg-slate-100",children:e.jsx("div",{className:"h-2 rounded-full bg-gradient-to-r from-blue-500 to-teal-500",style:{width:`${n.progress}%`},"aria-hidden":"true"})}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[n.progress,"% complete"]})]})]}):e.jsx("div",{className:"rounded-2xl border border-slate-200/70 bg-slate-50/80 px-4 py-5 text-sm text-slate-600",children:"We could not determine your current academic session. Visit the calendar to review upcoming terms."}),c&&e.jsxs("div",{className:"rounded-2xl border border-blue-200 bg-blue-50/80 px-4 py-4",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-blue-600",children:"Next Term"}),e.jsx("p",{className:"mt-1 text-sm font-medium text-slate-800",children:c.label}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Starts ",c.startLabel]}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:c.description}),e.jsxs(W,{size:"sm",variant:"ghost",className:"mt-3 text-blue-700 hover:bg-blue-100",onClick:()=>r("/sessions"),children:["Review Requirements",e.jsx(Q,{className:"ml-2 h-4 w-4","aria-hidden":"true"})]})]})]})]})]})}function re({onNavigate:s}){return e.jsxs(f,{className:"h-full",children:[e.jsxs(y,{children:[e.jsxs(w,{className:"flex items-center gap-2 text-base font-semibold text-slate-800",children:[e.jsx(K,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"}),"Support & Resources"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Quick access to help, advising, and campus resources."})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("section",{className:"rounded-2xl border border-slate-200/70 bg-white px-4 py-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Academic Advisor"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Reach out to your advisor for curriculum planning or career guidance."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2 text-sm text-slate-600",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-blue-50 px-3 py-1 text-xs font-medium text-blue-600",children:[e.jsx(S,{className:"h-4 w-4","aria-hidden":"true"}),"MD Program Office"]}),e.jsx(W,{variant:"outline",size:"sm",onClick:()=>s("/profile-setup"),children:"Message Advisor"})]})]}),e.jsxs("section",{className:"rounded-2xl border border-slate-200/70 bg-white px-4 py-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Student Services"}),e.jsxs("ul",{className:"mt-2 list-disc space-y-2 pl-4 text-sm text-slate-600",children:[e.jsxs("li",{children:["Schedule immunizations or compliance updates in"," ",e.jsx("button",{type:"button",className:"font-medium text-blue-600 underline",onClick:()=>s("/immunizations"),children:"Immunizations"})]}),e.jsxs("li",{children:["Track clinical hours in"," ",e.jsx("button",{type:"button",className:"font-medium text-blue-600 underline",onClick:()=>s("/clinical"),children:"Clinical Rotations"})]}),e.jsxs("li",{children:["Update personal details in"," ",e.jsx("button",{type:"button",className:"font-medium text-blue-600 underline",onClick:()=>s("/settings"),children:"Settings"})]})]})]}),e.jsx("section",{className:"rounded-2xl border border-slate-200/70 bg-slate-50/80 px-4 py-4 text-sm text-slate-600",children:e.jsxs("p",{children:["Need technical assistance? Visit the ",e.jsx("button",{type:"button",className:"font-medium text-blue-600 underline",onClick:()=>s("/announcements"),children:"Help Center"})," or email",e.jsx("a",{className:"ml-1 font-medium text-blue-600",href:"mailto:support@jfkmed.edu",children:"support@jfkmed.edu"}),"."]})})]})]})}se.displayName="QuickActions";const ie=l.memo(function(){const{user:h,role:g,mdYear:f,loading:v}=s(),y=r(),[w,D]=l.useState([]),[S,C]=l.useState([]),[A,k]=l.useState(null),[T,M]=l.useState([]),[z,I]=l.useState([]),[L,P]=l.useState(0),[B,$]=l.useState(0),[U,O]=l.useState(null),[F,G]=l.useState(null),V=l.useMemo(()=>U?j(U):void 0,[U]),[E,R]=l.useState(!0),Y=h||null,H=g||"student",q=f||void 0,Q="student"===H,K="teacher"===H,J="admin"===H,W=l.useMemo(()=>Y?.displayName||Y?.email?.split("@")[0]||"",[Y?.displayName,Y?.email]),ie=l.useMemo(()=>A?{...A,studentPercentage:A.totalUsers>0?A.students/A.totalUsers*100:0,teacherPercentage:A.totalUsers>0?A.teachers/A.totalUsers*100:0}:null,[A]),ne=l.useMemo(()=>{const e=new Map;return w.forEach(s=>{s.id&&e.set(s.id,s)}),e},[w]),ce=l.useMemo(()=>{if(!Q)return new Set;const e=new Set;return S.forEach(s=>{s.courseId&&e.add(s.courseId)}),e},[Q,S]),de=l.useMemo(()=>{if(!Q)return 0;let e=0;return ce.forEach(s=>{const t=ne.get(s);t?.credits&&(e+=t.credits)}),e},[Q,ce,ne]),oe=l.useMemo(()=>Q?ce.size:w.length,[Q,ce,w]),me=l.useMemo(()=>Q?[...T].sort((e,s)=>(e.dueAt??0)-(s.dueAt??0)).slice(0,4).map(e=>({...e,id:e.id??`${e.courseId}-${e.dueAt}`,courseTitle:e.courseId?ne.get(e.courseId)?.title:void 0})):[],[Q,T,ne]),xe=l.useMemo(()=>Q?z.map(e=>({...e,id:e.id??`${e.courseId}-${e.dueAt}`,courseTitle:e.courseId?ne.get(e.courseId)?.title:void 0})):[],[Q,z,ne]),ue=l.useMemo(()=>0===S.length?{}:S.reduce((e,s)=>(s.courseId&&(e[s.courseId]=(e[s.courseId]||0)+1),e),{}),[S]),he=l.useCallback(e=>{y(`/courses/${e}`)},[y]),ge=l.useCallback(e=>{y(e)},[y]);return l.useEffect(()=>{(async()=>{if(!v&&Y)try{R(!0);const s=await Promise.allSettled([n(),"admin"===H?t():Promise.resolve(null),p()]),[l,r,i]=s;if("fulfilled"===l.status&&D(l.value),"fulfilled"===r.status&&r.value&&k(r.value),"fulfilled"===i.status){const e=i.value??[];O(b(e)),G(N(e))}let h;if(Q&&Y?.uid)try{const e=await a(Y.uid);h=e?.id}catch(e){console.error("Failed to load student profile for dashboard:",e)}if(Q&&Y?.email){const[e,s,t,a,l]=await Promise.allSettled([c(h??Y.uid??Y.email),o(h??Y.uid??Y.email),m(h??Y.uid??Y.email),x(h??Y.uid??Y.email),u(h??Y.uid??Y.email)]);"fulfilled"===e.status&&C(e.value),"fulfilled"===s.status&&M(s.value),"fulfilled"===t.status&&I(t.value),"fulfilled"===a.status&&P(a.value),"fulfilled"===l.status&&$(l.value)}else{const[e]=await Promise.allSettled([d()]);if("fulfilled"===e.status&&C(e.value),(K||J)&&Y?.uid){const e=await m(Y.uid);I(e)}}}catch(s){console.error("Error fetching dashboard data:",s)}finally{R(!1)}})()},[v,Y,H,J,Q,K]),v||E?e.jsxs("div",{className:"space-y-6",children:[e.jsx(i,{title:"Dashboard"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg animate-pulse"},t))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-64 bg-gray-200 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded-lg animate-pulse"})]})]}):Q?e.jsxs("div",{className:"space-y-8",children:[e.jsx(i,{title:"Student Dashboard",userName:W,role:H,mdYear:q}),e.jsx(te,{mdYear:q,overallGrade:L,attendance:B,creditsInProgress:de,enrolledCourses:oe,currentSemester:V}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:[e.jsx("div",{className:"space-y-6 xl:col-span-2",children:e.jsx(ae,{upcomingAssignments:me,overdueAssignments:xe,onNavigate:ge})}),e.jsx(le,{currentSession:U,nextSession:F,upcomingAssignments:me,onNavigate:ge})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3 2xl:grid-cols-4",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-2 2xl:col-span-3",children:[e.jsx(Z,{courses:w,enrollments:S,courseEnrollments:ue,coursesLoading:E,role:H,onNavigateToCourse:he}),e.jsx(se,{role:H,onNavigate:ge})]}),e.jsx(re,{onNavigate:ge})]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsx(i,{title:"Dashboard",userName:W,role:H,mdYear:q}),J&&e.jsx(X,{userStats:ie,statsLoading:E,role:H}),e.jsx(se,{role:H,onNavigate:ge}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsx(Z,{courses:w,enrollments:S,courseEnrollments:ue,coursesLoading:E,role:H,onNavigateToCourse:he}),e.jsx(_,{assignmentsDue:T,overdueAssignments:z,overallGrade:L,attendance:B})]}),e.jsx(ee,{currentSession:U,nextSession:F,sessionsLoading:E})]})});export{ie as default};
