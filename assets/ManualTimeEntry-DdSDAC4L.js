import{j as e,u as a,d as s}from"./index-SvUTDYpM.js";import{r as t}from"./react-c0U51vzo.js";import{C as r,b as i}from"./card-C7UMvtm_.js";import{B as n}from"./button-C_oKDOXG.js";import{I as l}from"./input-Cf836u6s.js";import{P as o,D as d,a as c,b as m,c as u,d as p,p as x}from"./dialog-DgztDh9B.js";import{c as f}from"./utils-CCUt_dAN.js";import{c as h}from"./utils-DYr6ILV-.js";import{d as j,h as y}from"./timeTracking-D3CiIPd0.js";import{P as g,f as v}from"./icons-C41eJsKq.js";var b=t.forwardRef((a,s)=>e.jsx(o.label,{...a,ref:s,onMouseDown:e=>{e.target.closest("button, input, select, textarea")||(a.onMouseDown?.(e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));b.displayName="Label";var k=b;const N=f("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),w=t.forwardRef(({className:a,...s},t)=>e.jsx(k,{ref:t,className:h(N(),a),...s}));w.displayName=k.displayName;const T=t.forwardRef(({className:a,...s},t)=>e.jsx("textarea",{className:h("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...s}));function D({onEntryAdded:r}){const{user:i}=a(),{push:o}=s(),[f,h]=t.useState(!1),[b,k]=t.useState(!1),[N,D]=t.useState({date:j(new Date),clockInTime:"09:00",clockOutTime:"17:00",notes:""}),C=(e,a)=>{D(s=>({...s,[e]:a}))};return e.jsxs(d,{open:f,onOpenChange:h,children:[e.jsx(c,{asChild:!0,children:e.jsxs(n,{variant:"outline",className:"w-full",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Add Manual Entry"]})}),e.jsxs(m,{className:"sm:max-w-[425px]",children:[e.jsxs(u,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),"Add Manual Time Entry"]}),e.jsx(x,{children:"Add a time entry for a day when you forgot to clock in/out. This will be saved as a manual entry."})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!i?.uid)return;const a=new Date(`${N.date}T${N.clockInTime}`);if(new Date(`${N.date}T${N.clockOutTime}`)<=a)o({title:"Invalid Time",description:"Clock out time must be after clock in time",variant:"error"});else{k(!0);try{await y(i.uid,N.date,N.clockInTime,N.clockOutTime,N.notes||void 0),o({title:"Time Entry Added",description:"Manual time entry has been recorded",variant:"success"}),D({date:j(new Date),clockInTime:"09:00",clockOutTime:"17:00",notes:""}),h(!1),r?.()}catch(s){o({title:"Error",description:"Failed to add manual time entry",variant:"error"})}finally{k(!1)}}},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"date",children:"Date"}),e.jsx(l,{id:"date",type:"date",value:N.date,onChange:e=>C("date",e.target.value),required:!0}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Will be saved as: ",new Date(N.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"clockIn",children:"Clock In"}),e.jsx(l,{id:"clockIn",type:"time",value:N.clockInTime,onChange:e=>C("clockInTime",e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"clockOut",children:"Clock Out"}),e.jsx(l,{id:"clockOut",type:"time",value:N.clockOutTime,onChange:e=>C("clockOutTime",e.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(T,{id:"notes",placeholder:"e.g., Worked from home, meeting, etc.",value:N.notes,onChange:e=>C("notes",e.target.value),rows:3})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>h(!1),disabled:b,children:"Cancel"}),e.jsx(n,{type:"submit",disabled:b,children:b?"Adding...":"Add Entry"})]})]})]})]})}function C({onEntryAdded:a}){return e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsx(D,{onEntryAdded:a})})})}T.displayName="Textarea";export{D as M,C as Q};
