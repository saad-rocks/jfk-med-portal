import{u as e,j as s}from"./index-SvUTDYpM.js";import{u as a,g as t,r}from"./react-c0U51vzo.js";import"./firebase-Bz9ybdfi.js";import{l as i}from"./assignments-Dtn30G5f.js";import{C as l,b as n}from"./card-C7UMvtm_.js";import{B as c}from"./button-C_oKDOXG.js";import{B as o}from"./badge-mKe8BOon.js";import{I as d}from"./input-Cf836u6s.js";import{T as m}from"./tabs-DFGuuRa4.js";import{P as x,S as u,a7 as g,a8 as h,D as j,R as p,a9 as f,F as b,C as N,b as y,c as v,u as w,m as z,s as C,aa as S}from"./icons-C41eJsKq.js";import"./utils-CCUt_dAN.js";function k(){const k=a(),{courseId:A}=t(),{role:D}=e(),[L,P]=r.useState([]),[F,M]=r.useState(!0),[q,E]=r.useState("all"),[Q,T]=r.useState("all"),[B,V]=r.useState(""),[G,H]=r.useState("dueDate"),[I,O]=r.useState("desc"),[$,J]=r.useState(new Set),[R,U]=r.useState(!1);r.useEffect(()=>{(async()=>{if(A)try{const e=await i(A);P(e)}catch(e){console.error("Error fetching assignments:",e)}finally{M(!1)}})()},[A]);const W=r.useMemo(()=>{let e=L.filter(e=>("all"===q||e.type===q)&&!(B&&!e.title.toLowerCase().includes(B.toLowerCase())));return e.sort((e,s)=>{let a,t;switch(G){case"dueDate":default:a=e.dueAt,t=s.dueAt;break;case"name":a=e.title.toLowerCase(),t=s.title.toLowerCase();break;case"createdAt":a=e.createdAt,t=s.createdAt}return"asc"===I?a>t?1:-1:a<t?1:-1}),e},[L,q,B,G,I]),K=e=>{switch(e){case"quiz":return"Quiz";case"hw":return"Homework";case"midterm":return"Midterm";case"final":return"Final";default:return e}},X=e=>{switch(e){case"quiz":return"bg-green-100 text-green-700 border-green-200";case"hw":return"bg-purple-100 text-purple-700 border-purple-200";case"midterm":return"bg-orange-100 text-orange-700 border-orange-200";case"final":return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},Y=e=>{const s=new Set($);s.has(e)?s.delete(e):s.add(e),J(s),U(s.size>0)},Z=e=>s.jsx("div",{className:"space-y-4",children:0===e.length?s.jsx(l,{children:s.jsxs(n,{className:"py-12 text-center",children:[s.jsx(b,{size:48,className:"mx-auto text-gray-300 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No assignments found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:B||"all"!==Q||"all"!==q?"Try adjusting your filters or search terms.":"Start by creating your first assignment for this course."}),!B&&"all"===Q&&"all"===q&&s.jsxs(c,{onClick:()=>{window.scrollTo({top:0,behavior:"smooth"}),k("/assignments/new")},className:"flex items-center gap-2",children:[s.jsx(x,{size:16}),"Create First Assignment"]})]})}):s.jsx("div",{className:"grid gap-4",children:e.map(e=>{const a=(e=>{const s=Date.now();if(e.dueAt<s)return{status:"overdue",label:"Overdue",color:"bg-red-100 text-red-700"};const a=Math.ceil((e.dueAt-s)/864e5);return a<=3?{status:"due-soon",label:`Due in ${a} days`,color:"bg-yellow-100 text-yellow-700"}:{status:"active",label:"Active",color:"bg-green-100 text-green-700"}})(e),t=$.has(e.id);return s.jsx(l,{className:"hover:shadow-md transition-all duration-200 cursor-pointer "+(t?"ring-2 ring-medical-500 bg-medical-50":""),onClick:()=>Y(e.id),children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("input",{type:"checkbox",checked:t,onChange:s=>{s.stopPropagation(),Y(e.id)},className:"w-4 h-4 text-medical-600 border-gray-300 rounded focus:ring-medical-500"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),s.jsx(o,{className:X(e.type),children:K(e.type)}),s.jsx(o,{className:a.color,children:a.label})]}),s.jsx("p",{className:"text-gray-600 mb-3",children:e.instructions}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(N,{size:14}),s.jsxs("span",{children:["Due: ",new Date(e.dueAt).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(y,{size:14}),s.jsxs("span",{children:[e.maxPoints," points"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(v,{size:14}),s.jsxs("span",{children:["Weight: ",e.weight,"%"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(w,{size:14}),s.jsx("span",{children:"0 submissions"})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(c,{variant:"outline",size:"sm",className:"flex items-center gap-1",asChild:!0,onClick:e=>e.stopPropagation(),children:s.jsxs("a",{href:`/assignments/${e.id}/grade`,children:[s.jsx(z,{size:14}),"View Submissions"]})}),s.jsxs(c,{variant:"outline",size:"sm",onClick:e=>e.stopPropagation(),children:[s.jsx(C,{size:14}),"Comments"]}),s.jsx(c,{variant:"outline",size:"sm",onClick:e=>e.stopPropagation(),children:s.jsx(S,{size:16})})]})]})})},e.id)})})});return F?s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"text-gray-600",children:"Loading assignments..."})]})}):"teacher"!==D&&"admin"!==D?s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Access Denied"}),s.jsx("p",{className:"text-red-700",children:"Only teachers and administrators can access this page."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Course Assignments"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Manage and grade assignments for this course"})]}),s.jsxs(c,{className:"flex items-center gap-2 bg-medical-600 hover:bg-medical-700",onClick:()=>{window.scrollTo({top:0,behavior:"smooth"}),k("/assignments/new")},children:[s.jsx(x,{size:16}),"Create Assignment"]})]}),s.jsx(l,{children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(d,{placeholder:"Search assignments...",value:B,onChange:e=>V(e.target.value),className:"pl-10"})]}),s.jsxs("select",{value:Q,onChange:e=>T(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-medical-500",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"not-submitted",children:"Not Submitted"}),s.jsx("option",{value:"submitted",children:"Submitted"}),s.jsx("option",{value:"graded",children:"Graded"})]}),s.jsxs("select",{value:G,onChange:e=>H(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-medical-500",children:[s.jsx("option",{value:"dueDate",children:"Sort by Due Date"}),s.jsx("option",{value:"name",children:"Sort by Name"}),s.jsx("option",{value:"createdAt",children:"Sort by Created"})]}),s.jsxs(c,{variant:"outline",onClick:()=>O("asc"===I?"desc":"asc"),className:"flex items-center gap-2",children:["asc"===I?s.jsx(g,{size:16}):s.jsx(h,{size:16}),"asc"===I?"Ascending":"Descending"]})]})})}),R&&s.jsx(l,{className:"border-medical-200 bg-medical-50",children:s.jsx(n,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm font-medium text-medical-800",children:[$.size," assignment(s) selected"]}),s.jsx(c,{variant:"outline",size:"sm",onClick:()=>{$.size===W.length?(J(new Set),U(!1)):(J(new Set(W.map(e=>e.id))),U(!0))},className:"text-medical-600 border-medical-300",children:$.size===W.length?"Deselect All":"Select All"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{console.log("Bulk download for:",Array.from($))},className:"flex items-center gap-2",children:[s.jsx(j,{size:16}),"Download All"]}),s.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{console.log("Quick grade for:",Array.from($))},className:"flex items-center gap-2",children:[s.jsx(p,{size:16}),"Quick Grade"]}),s.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{console.log("CSV export for:",Array.from($))},className:"flex items-center gap-2",children:[s.jsx(f,{size:16}),"Export CSV"]})]})]})})}),s.jsx(m,{tabs:[{key:"all",label:"All",content:Z(W)},{key:"quiz",label:"Quiz",content:Z(W.filter(e=>"quiz"===e.type))},{key:"hw",label:"Homework",content:Z(W.filter(e=>"hw"===e.type))},{key:"midterm",label:"Midterm",content:Z(W.filter(e=>"midterm"===e.type))},{key:"final",label:"Final",content:Z(W.filter(e=>"final"===e.type))}]})]})}export{k as default};
