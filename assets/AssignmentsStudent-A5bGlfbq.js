import{u as e,j as s}from"./index-SvUTDYpM.js";import{u as t,g as r,r as a}from"./react-c0U51vzo.js";import"./firebase-Bz9ybdfi.js";import{l}from"./assignments-Dtn30G5f.js";import{getSubmissionForStudent as i}from"./submissions-DoHwV8XX.js";import{C as n,b as d}from"./card-C7UMvtm_.js";import{B as o}from"./button-C_oKDOXG.js";import{B as c}from"./badge-mKe8BOon.js";import{I as m}from"./input-Cf836u6s.js";import{T as u}from"./tabs-DFGuuRa4.js";import{p as x,T as g,B as h,t as b,ab as j,F as p,ac as f,f as N,S as v,C as y,V as w,R as S,o as z,n as D,m as O,D as k}from"./icons-C41eJsKq.js";import"./utils-CCUt_dAN.js";function C(){const C=t(),{courseId:A}=r(),{role:F,user:M}=e(),[U,T]=a.useState([]),[$,L]=a.useState([]),[P,E]=a.useState(!0),[V,q]=a.useState(null),[G,I]=a.useState("all"),[B,H]=a.useState("all"),[Q,R]=a.useState("");a.useEffect(()=>{(async()=>{if(A)try{const e=await l(A);T(e)}catch(e){console.error("Error fetching assignments:",e)}finally{E(!1)}})()},[A]),a.useEffect(()=>{U.length>0&&(async()=>{if(M&&A)try{const e=await Promise.all(U.map(async e=>{try{const s=await i(e.id,M.uid),t=Date.now(),r=Math.ceil((e.dueAt-t)/864e5),a=e.dueAt<t,l=!a&&r<=3;let n="not-started";return s?n=s.grade.gradedAt?"graded":"submitted":a?n="overdue":l&&(n="in-progress"),{...e,submission:s,status:n,daysUntilDue:r,isOverdue:a,isDueSoon:l}}catch(s){return console.error(`Error fetching submission for assignment ${e.id}:`,s),{...e,submission:null,status:"not-started",daysUntilDue:Math.ceil((e.dueAt-Date.now())/864e5),isOverdue:e.dueAt<Date.now(),isDueSoon:!1}}}));L(e)}catch(e){console.error("Error fetching submissions:",e)}})()},[U,M]);const J=a.useMemo(()=>({total:$.length,completed:$.filter(e=>"graded"===e.status).length,submitted:$.filter(e=>"submitted"===e.status).length,overdue:$.filter(e=>"overdue"===e.status).length,dueSoon:$.filter(e=>e.isDueSoon&&!e.isOverdue).length,notStarted:$.filter(e=>"not-started"===e.status).length}),[$]),Y=a.useMemo(()=>{let e=$.filter(e=>("all"===G||e.type===G)&&(("all"===B||e.status===B)&&!(Q&&!e.title.toLowerCase().includes(Q.toLowerCase()))));return e.sort((e,s)=>e.isOverdue&&!s.isOverdue?-1:!e.isOverdue&&s.isOverdue?1:!e.isDueSoon||s.isDueSoon||e.isOverdue?e.isDueSoon||!s.isDueSoon||s.isOverdue?e.dueAt-s.dueAt:1:-1),e},[$,G,B,Q]),K=e=>{H(e),I("all"),R("")},W=e=>{switch(e){case"hw":return"bg-blue-100 text-blue-700 border-blue-200";case"quiz":return"bg-green-100 text-green-700 border-green-200";case"midterm":return"bg-orange-100 text-orange-700 border-orange-200";case"final":return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},X=e=>{switch(e){case"hw":return"Homework";case"quiz":return"Quiz";case"midterm":return"Midterm";case"final":return"Final";default:return e}},Z=e=>{switch(e){case"not-started":default:return"bg-gray-100 text-gray-700";case"in-progress":return"bg-yellow-100 text-yellow-700";case"submitted":return"bg-blue-100 text-blue-700";case"graded":return"bg-green-100 text-green-700";case"overdue":return"bg-red-100 text-red-700"}},_=e=>{switch(e){case"not-started":return"Not Started";case"in-progress":return"In Progress";case"submitted":return"Submitted";case"graded":return"Graded";case"overdue":return"Overdue";default:return"Unknown"}},ee=e=>{if(e.isOverdue){const s=Math.abs(e.daysUntilDue);return`Overdue by ${s} day${1!==s?"s":""}`}return e.isDueSoon?0===e.daysUntilDue?"Due today":1===e.daysUntilDue?"Due tomorrow":`Due in ${e.daysUntilDue} days`:`Due ${new Date(e.dueAt).toLocaleDateString()}`},se=e=>s.jsx("div",{className:"space-y-4",children:0===e.length?s.jsx(n,{children:s.jsxs(d,{className:"py-12 text-center",children:[s.jsx(p,{size:48,className:"mx-auto text-gray-300 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No assignments found"}),s.jsx("p",{className:"text-gray-600",children:Q||"all"!==B||"all"!==G?"Try adjusting your filters or search terms.":"Your instructor hasn't posted any assignments for this course yet."})]})}):s.jsx("div",{className:"grid gap-4",children:e.map(e=>s.jsx(n,{className:"hover:shadow-lg transition-all duration-200 border-2 "+(e.isOverdue?"border-red-300 bg-red-50/50 shadow-red-100":e.isDueSoon?"border-yellow-300 bg-yellow-50/50 shadow-yellow-100":"graded"===e.status?"border-green-300 bg-green-50/30":"border-gray-200 hover:border-blue-300"),children:s.jsxs(d,{className:"p-6",children:[e.isOverdue&&s.jsxs("div",{className:"flex items-center gap-2 mb-4 p-2 bg-red-100 border border-red-200 rounded-lg",children:[s.jsx(g,{size:16,className:"text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-red-800",children:"⚠️ Overdue - Submit immediately!"})]}),e.isDueSoon&&!e.isOverdue&&s.jsxs("div",{className:"flex items-center gap-2 mb-4 p-2 bg-yellow-100 border border-yellow-200 rounded-lg",children:[s.jsx(h,{size:16,className:"text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"⏰ Due soon - Don't forget!"})]}),s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 leading-tight",children:e.title}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(c,{className:`${W(e.type)} font-medium`,children:X(e.type)}),s.jsx(c,{className:`${Z(e.status)} font-medium`,children:_(e.status)})]})]}),s.jsx("p",{className:"text-gray-600 mb-3",children:e.instructions}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(y,{size:16,className:"text-gray-500"}),s.jsx("span",{className:e.isOverdue?"text-red-600 font-medium":"text-gray-700",children:ee(e)})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(w,{size:16,className:"text-gray-500"}),s.jsxs("span",{className:"text-gray-700",children:[e.maxPoints," points"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(S,{size:16,className:"text-gray-500"}),s.jsxs("span",{className:"text-gray-700",children:[e.weight,"% weight"]})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm",children:e.submission?s.jsxs(s.Fragment,{children:[s.jsx(b,{size:16,className:"text-green-500"}),s.jsx("span",{className:"text-green-700 font-medium",children:"Submitted"})]}):s.jsxs(s.Fragment,{children:[s.jsx(N,{size:16,className:"text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:"Not submitted"})]})})]}),e.submission&&s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(z,{size:16,className:"text-green-600"}),s.jsxs("div",{className:"text-sm",children:[s.jsxs("p",{className:"text-gray-800 font-medium",children:["Submitted on ",new Date(e.submission.submittedAt).toLocaleDateString()]}),e.submission.grade.gradedAt&&s.jsxs("p",{className:"text-gray-600",children:["Grade: ",e.submission.grade.points," / ",e.maxPoints," points",e.submission.grade.feedback&&s.jsxs("span",{className:"ml-2",children:["• ",e.submission.grade.feedback]})]})]})]})}),e.isOverdue&&!e.submission&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(D,{size:16,className:"text-red-600"}),s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("p",{className:"font-medium",children:"This assignment is overdue"}),s.jsx("p",{children:"Late submissions may incur penalties. Contact your instructor if you need an extension."})]})]})}),e.isDueSoon&&!e.submission&&!e.isOverdue&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(h,{size:16,className:"text-yellow-600"}),s.jsxs("div",{className:"text-sm text-yellow-800",children:[s.jsx("p",{className:"font-medium",children:"Assignment due soon!"}),s.jsx("p",{children:"Make sure to submit before the deadline to avoid late penalties."})]})]})})]}),s.jsxs("div",{className:"flex flex-col gap-3 ml-6",children:[s.jsx(o,{className:"flex items-center gap-2 font-medium "+(e.isOverdue?"bg-red-600 hover:bg-red-700 text-white":e.isDueSoon?"bg-yellow-600 hover:bg-yellow-700 text-white":e.submission?"bg-blue-600 hover:bg-blue-700 text-white":"bg-green-600 hover:bg-green-700 text-white"),onClick:()=>{window.scrollTo({top:0,behavior:"smooth"}),q(e),C(`/assignments/${e.id}/submit`)},children:e.submission?s.jsxs(s.Fragment,{children:[s.jsx(O,{size:16}),"View Submission"]}):s.jsxs(s.Fragment,{children:[s.jsx(b,{size:16}),e.isOverdue?"Submit Now":"Submit Assignment"]})}),s.jsxs("div",{className:"flex gap-2",children:[e.submission&&s.jsx(o,{variant:"outline",size:"sm",className:"flex items-center gap-1 text-blue-600 border-blue-200 hover:bg-blue-50",asChild:!0,children:s.jsxs("a",{href:e.submission.fileUrl,download:!0,children:[s.jsx(k,{size:14}),"Download"]})}),s.jsx("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-100 rounded-md text-xs text-gray-600",children:"graded"===e.status?s.jsxs(s.Fragment,{children:[s.jsx(z,{size:12,className:"text-green-600"}),"Graded"]}):"submitted"===e.status?s.jsxs(s.Fragment,{children:[s.jsx(N,{size:12,className:"text-blue-600"}),"Pending"]}):"overdue"===e.status?s.jsxs(s.Fragment,{children:[s.jsx(g,{size:12,className:"text-red-600"}),"Overdue"]}):s.jsxs(s.Fragment,{children:[s.jsx(f,{size:12,className:"text-gray-600"}),"Ready"]})})]})]})]})]})},e.id))})});return P?s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"text-gray-600",children:"Loading assignments..."})]})}):"student"!==F?s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Access Denied"}),s.jsx("p",{className:"text-red-700",children:"Only students can access this page."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Assignments"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Track your progress and submit assignments on time"})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(c,{className:"bg-blue-100 text-blue-700 border-blue-200",children:[s.jsx(x,{size:14,className:"mr-1"}),J.completed,"/",J.total," Completed"]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(n,{className:"border-l-4 border-l-red-500",children:s.jsxs(d,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:J.overdue})]}),s.jsx(g,{className:"h-8 w-8 text-red-500"})]}),J.overdue>0&&s.jsx(o,{size:"sm",variant:"outline",className:"mt-2 w-full border-red-200 text-red-600 hover:bg-red-50",onClick:()=>K("overdue"),children:"View Overdue"})]})}),s.jsx(n,{className:"border-l-4 border-l-yellow-500",children:s.jsxs(d,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Due Soon"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:J.dueSoon})]}),s.jsx(h,{className:"h-8 w-8 text-yellow-500"})]}),J.dueSoon>0&&s.jsx(o,{size:"sm",variant:"outline",className:"mt-2 w-full border-yellow-200 text-yellow-600 hover:bg-yellow-50",onClick:()=>K("in-progress"),children:"View Due Soon"})]})}),s.jsx(n,{className:"border-l-4 border-l-blue-500",children:s.jsxs(d,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Submitted"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:J.submitted})]}),s.jsx(b,{className:"h-8 w-8 text-blue-500"})]}),J.submitted>0&&s.jsx(o,{size:"sm",variant:"outline",className:"mt-2 w-full border-blue-200 text-blue-600 hover:bg-blue-50",onClick:()=>K("submitted"),children:"View Submitted"})]})}),s.jsx(n,{className:"border-l-4 border-l-green-500",children:s.jsxs(d,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:J.completed})]}),s.jsx(j,{className:"h-8 w-8 text-green-500"})]}),J.completed>0&&s.jsx(o,{size:"sm",variant:"outline",className:"mt-2 w-full border-green-200 text-green-600 hover:bg-green-50",onClick:()=>K("graded"),children:"View Grades"})]})})]}),J.total>0&&s.jsx(n,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:s.jsxs(d,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overall Progress"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[J.completed+J.submitted," of ",J.total," assignments"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-2",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-3 rounded-full transition-all duration-300",style:{width:(J.completed+J.submitted)/J.total*100+"%"}})}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[s.jsx("span",{children:"0%"}),s.jsxs("span",{children:[Math.round((J.completed+J.submitted)/J.total*100),"% Complete"]}),s.jsx("span",{children:"100%"})]})]})}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[s.jsxs(o,{variant:"all"!==B||"all"!==G||Q?"outline":"primary",size:"sm",onClick:()=>{H("all"),I("all"),R("")},className:"flex items-center gap-1",children:[s.jsx(p,{size:14}),"All Assignments"]}),s.jsxs(o,{variant:"not-started"===B?"primary":"outline",size:"sm",onClick:()=>K("not-started"),className:"flex items-center gap-1",children:[s.jsx(f,{size:14}),"To Do (",J.notStarted,")"]}),s.jsxs(o,{variant:"in-progress"===B?"primary":"outline",size:"sm",onClick:()=>K("in-progress"),className:"flex items-center gap-1",children:[s.jsx(N,{size:14}),"Due Soon (",J.dueSoon,")"]}),s.jsxs(o,{variant:"overdue"===B?"danger":"outline",size:"sm",onClick:()=>K("overdue"),className:"flex items-center gap-1 bg-red-50 border-red-200 text-red-700 hover:bg-red-100",children:[s.jsx(g,{size:14}),"Overdue (",J.overdue,")"]}),s.jsxs(o,{variant:"submitted"===B?"primary":"outline",size:"sm",onClick:()=>K("submitted"),className:"flex items-center gap-1",children:[s.jsx(b,{size:14}),"Submitted (",J.submitted,")"]}),s.jsxs(o,{variant:"graded"===B?"success":"outline",size:"sm",onClick:()=>K("graded"),className:"flex items-center gap-1",children:[s.jsx(j,{size:14}),"Completed (",J.completed,")"]})]}),s.jsx(n,{className:"mb-6",children:s.jsx(d,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(m,{placeholder:"Search by assignment name...",value:Q,onChange:e=>R(e.target.value),className:"pl-10"})]}),s.jsxs("select",{value:B,onChange:e=>H(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[s.jsx("option",{value:"all",children:"📋 All Status"}),s.jsx("option",{value:"not-started",children:"🔄 Not Started"}),s.jsx("option",{value:"in-progress",children:"⏳ In Progress"}),s.jsx("option",{value:"submitted",children:"📤 Submitted"}),s.jsx("option",{value:"graded",children:"✅ Graded"}),s.jsx("option",{value:"overdue",children:"🚨 Overdue"})]}),s.jsxs("select",{value:G,onChange:e=>I(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[s.jsx("option",{value:"all",children:"📚 All Types"}),s.jsx("option",{value:"hw",children:"📝 Homework"}),s.jsx("option",{value:"quiz",children:"🧠 Quiz"}),s.jsx("option",{value:"midterm",children:"📊 Midterm"}),s.jsx("option",{value:"final",children:"🎓 Final"})]})]})})}),s.jsx(u,{tabs:[{key:"all",label:"All",content:se(Y)},{key:"quiz",label:"Quiz",content:se(Y.filter(e=>"quiz"===e.type))},{key:"hw",label:"Homework",content:se(Y.filter(e=>"hw"===e.type))},{key:"midterm",label:"Midterm",content:se(Y.filter(e=>"midterm"===e.type))},{key:"final",label:"Final",content:se(Y.filter(e=>"final"===e.type))}]})]})}export{C as default};
