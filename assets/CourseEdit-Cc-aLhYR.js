import{u as e,j as s}from"./index-SvUTDYpM.js";import{u as t,g as r,r as a}from"./react-c0U51vzo.js";import{P as i}from"./PageHeader-yfs0G1du.js";import{C as l,b as c}from"./card-C7UMvtm_.js";import{I as d}from"./input-Cf836u6s.js";import{B as o}from"./button-C_oKDOXG.js";import{u as n}from"./coursesSecure-jGot-HE8.js";import{getCourseById as m}from"./enrollments-3oX83C0U.js";import"./firebase-Bz9ybdfi.js";import"./icons-C41eJsKq.js";import"./utils-CCUt_dAN.js";function u(){const u=t(),{role:x,user:j}=e(),{courseId:p}=r(),[h,b]=a.useState(!0),[f,g]=a.useState(!1),[v,N]=a.useState(!1),[y,C]=a.useState({code:"",title:"",credits:0,semester:"MD-1",instructor:"",description:""});a.useEffect(()=>{(async()=>{if(p){b(!0);try{const e=await m(p);e&&(C({code:String(e.code||""),title:String(e.title||""),credits:Number(e.credits||0),semester:String(e.semester||"MD-1"),instructor:String(e.instructor||""),description:String(e.description||"")}),N(!!j?.uid&&String(e.ownerId)===j.uid))}finally{b(!1)}}})()},[p]);return"admin"!==x&&"teacher"!==x?s.jsxs("div",{className:"space-y-6",children:[s.jsx(i,{title:"Edit Course",breadcrumb:[{label:"Courses",to:"/courses"},{label:"Edit"}]}),s.jsx(l,{children:s.jsx(c,{className:"p-6",children:"Only admins and teachers can edit courses."})})]}):"teacher"!==x||v?s.jsxs("div",{className:"space-y-6",children:[s.jsx(i,{title:"Edit Course",breadcrumb:[{label:"Courses",to:"/courses"},{label:p||"Course"},{label:"Edit"}]}),h?s.jsx("div",{className:"h-40 rounded-xl bg-slate-100 animate-pulse"}):s.jsx(l,{children:s.jsx(c,{className:"p-6",children:s.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),p){g(!0);try{await n(p,{code:y.code.trim(),title:y.title.trim(),credits:Number(y.credits),semester:y.semester,instructor:y.instructor,description:y.description.trim()}),u(`/courses/${p}`,{replace:!0})}finally{g(!1)}}},className:"space-y-6 max-w-3xl",children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Course Code *"}),s.jsx(d,{value:y.code,onChange:e=>C({...y,code:e.target.value}),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Course Title *"}),s.jsx(d,{value:y.title,onChange:e=>C({...y,title:e.target.value}),required:!0})]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Credits *"}),s.jsx(d,{type:"number",min:0,value:y.credits,onChange:e=>C({...y,credits:Number(e.target.value)}),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Semester *"}),s.jsx("select",{className:"w-full h-11 border-2 border-slate-200 rounded-xl px-3",value:y.semester,onChange:e=>C({...y,semester:e.target.value}),children:Array.from({length:11},(e,s)=>`MD-${s+1}`).map(e=>s.jsx("option",{value:e,children:e},e))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Instructor"}),s.jsx(d,{value:y.instructor,onChange:e=>C({...y,instructor:e.target.value}),placeholder:"Instructor email or name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Description *"}),s.jsx("textarea",{className:"w-full border-2 border-slate-200 rounded-xl px-3 py-3 focus:border-blue-400 focus:outline-none resize-none",rows:4,value:y.description,onChange:e=>C({...y,description:e.target.value}),required:!0})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(o,{type:"button",variant:"outline",onClick:()=>u(-1),disabled:f,children:"Cancel"}),s.jsx(o,{type:"submit",disabled:f,children:f?"Saving...":"Save Changes"})]})]})})})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsx(i,{title:"Edit Course",breadcrumb:[{label:"Courses",to:"/courses"},{label:"Edit"}]}),s.jsx(l,{children:s.jsx(c,{className:"p-6",children:"Only the course owner (or an admin) can edit this course."})})]})}export{u as default};
